install.packages(c("remotes", "knitr", "rmarkdown"))
install.packages(c("remotes", "knitr", "rmarkdown"))
remotes::install_git("https://code.usgs.gov/usgs/norock/cross_p/cwdsims", build_vignettes = TRUE, build_manual = TRUE)
remotes::install_git("https://code.usgs.gov/usgs/norock/cross_p/cwdsims", build_vignettes = F, build_manual = TRUE)
library(CWDsims)
vignette(package = "CWDsims") # all vignettes available
vignette("CWDsimsIntroVignette") # load the introduction
?CWDsims
library(knitr)
library(CWDsims)
options(continue=" ")
options(width=60)
knitr::opts_chunk$set(echo = TRUE,
warning = FALSE,
message = FALSE,
fig.height = 4,
fig.width = 6)
params <- list(fawn.an.sur = 0.6, juv.an.sur = 0.8, ad.an.f.sur = 0.9,
ad.an.m.sur = 0.9, fawn.repro = 0, juv.repro = 0.6,
ad.repro = 1, hunt.mort.fawn = 0.01, hunt.mort.juv.f = 0.1,
hunt.mort.juv.m = 0.1, hunt.mort.ad.f = 0.1,
hunt.mort.ad.m = 0.2, ini.fawn.prev = 0.01, ini.juv.prev = 0.03,
ini.ad.f.prev = 0.04, ini.ad.m.prev = 0.04, n.age.cats = 12,
p = 0.43, env.foi = 0, beta.f = 0.08, beta.m = 0.08, theta = 1,
n0 = 1000, n.years = 10, rel.risk = 1.0)
# run the deterministic CWD model
out <- cwd_det_model(params)
summary(out)
head(out$counts)
head(out$deaths)
unique(out$deaths$category)
plot_tots(out$counts)
plot_prev_time(out$counts)
plot_prev_age_end(out$counts)
plot_age_dist(out$counts)
plot_deaths(out$deaths, percents = TRUE)
params.stoch <- list(fawn.an.sur = 0.6, juv.an.sur = 0.8, ad.an.f.sur = 0.95,
ad.an.m.sur = 0.9, fawn.repro = 0, juv.repro = 0.6, ad.repro = 1,
hunt.mort.fawn = 0.01, hunt.mort.juv.f = 0.1, hunt.mort.juv.m = 0.1,
hunt.mort.ad.f = 0.1, hunt.mort.ad.m = 0.2, ini.fawn.prev = 0.02,
ini.juv.prev = 0.03, ini.ad.f.prev = 0.04,  ini.ad.m.prev = 0.04,
n.age.cats = 12,  p = 0.43, env.foi = 0,  beta.f = 0.08,  beta.m = 0.08,
theta = 1, n0 = 1000, n.years = 10, rel.risk = 1.0,
repro.var = 0.005, fawn.sur.var = 0.005, sur.var = 0.005, hunt.var = 0.005)
out.stoch<- cwd_stoch_model(params.stoch)
plot_tots(out.stoch$counts)
out.wrap <- cwd_stoch_wrapper(params.stoch, nsims = 30)
out.wrap <- cwd_stoch_wrapper(params.stoch, nsims = 30)
plot_stoch_tots(out.wrap$counts, all.lines = TRUE, error.bars = c(0.05, 0.95),
by.sexage = TRUE)
plot_stoch_deaths(out.wrap$deaths, error.bars = c(0.05, 0.95))
params.wiw <- list(fawn.an.sur = 0.6, juv.an.sur = 0.8, ad.an.f.sur = 0.95,
ad.an.m.sur = 0.9, fawn.repro = 0, juv.repro = 0.6, ad.repro = 1,
hunt.mort.fawn = 0.01, hunt.mort.juv.f = 0.1, hunt.mort.juv.m = 0.1,
hunt.mort.ad.f = 0.1, hunt.mort.ad.m = 0.2, ini.fawn.prev = 0.02,
ini.juv.prev = 0.03, ini.ad.f.prev = 0.04,  ini.ad.m.prev = 0.04,
n.age.cats = 12,  p = 0.43, env.foi = 0,  beta.ff = 0.06,
gamma.mm = 2, gamma.mf = 2, gamma.fm = 1,
theta = 1, n0 = 2000, n.years = 10, rel.risk = 1.0)
out.wiw <- cwd_det_model_wiw(params.wiw)
plot_tots(out.wiw$counts)
params1 <- list(fawn.an.sur = 0.6, juv.an.sur = 0.8, ad.an.f.sur = 0.9,
ad.an.m.sur = 0.9, fawn.repro = 0, juv.repro = 0.6,
ad.repro = 1, hunt.mort.fawn = 0.01, hunt.mort.juv.f = 0.1,
hunt.mort.juv.m = 0.1, hunt.mort.ad.f = 0.1,
hunt.mort.ad.m = 0.2, ini.fawn.prev = 0.01, ini.juv.prev = 0.03,
ini.ad.f.prev = 0.04, ini.ad.m.prev = 0.04, n.age.cats = 12,
p = 0.43, env.foi = 0, beta.f = 0.08, beta.m = 0.08, theta = 1,
n0 = 1000, n.years = 10, rel.risk = 1.0)
# alter the male and female hunting rate for the 2nd scenario
params2 <- params1
params2$hunt.mort.ad.m <- 0.5
params2$hunt.mort.ad.f <- 0
out1 <- cwd_det_model(params1)
out2 <- cwd_det_model(params2)
plot_compare_all_det(out1, out2)
params.s1 <- list(fawn.an.sur = 0.6, juv.an.sur = 0.8, ad.an.f.sur = 0.95,
ad.an.m.sur = 0.9, fawn.repro = 0, juv.repro = 0.6, ad.repro = 1,
hunt.mort.fawn = 0.01, hunt.mort.juv.f = 0.1, hunt.mort.juv.m = 0.1,
hunt.mort.ad.f = 0.1, hunt.mort.ad.m = 0.2, ini.fawn.prev = 0.02,
ini.juv.prev = 0.03, ini.ad.f.prev = 0.04,  ini.ad.m.prev = 0.04,
n.age.cats = 12,  p = 0.43, env.foi = 0,  beta.f = 0.08,  beta.m = 0.08,
theta = 1, n0 = 1000, n.years = 10, rel.risk = 1.0,
repro.var = 0.005, fawn.sur.var = 0.005, sur.var = 0.005, hunt.var = 0.005)
# alter the male and female hunting rate for the 2nd scenario
params.s2 <- params.s1
params.s2$hunt.mort.ad.m <- 0.5
params.s2$hunt.mort.ad.f <- 0.01
# use the wrapper for this comparison
out.s1 <- cwd_stoch_wrapper(params.s1, nsims = 20)
# use the wrapper for this comparison
out.s1 <- cwd_stoch_wrapper(params.s1, nsims = 20)
out.s2 <- cwd_stoch_wrapper(params.s2, nsims = 20)
plot_compare_all_stoch(out.s1, out.s2)
?plot_age_dist
plot_age_dist(out$counts)
source("D:/Current Projects/GitLab/norock/cwdsims/R/plot_age_dist.r")
plot_age_dist(out$counts)
library(tidyverse)
plot_age_dist(out$counts)
setwd("D:/Current Projects/CWD/Modeling")
setwd("D:/Current Projects/CWD/Modeling")
library(tidyverse)
library(tidyverse)
elk <- read_csv("mt2020elk.csv")
deer <- read_csv("mt2020deer.csv")
head(elk)
head(deer)
View(elk)
names(elk) <- c("Year", "District", "Residency", "Hunters", "HunterDays", "Harvest", "Bulls", "Cows", "Calves", "Bow", "Rifle", "Spike", "Less6", "GE6")
elk <- read_csv("mt2020elk.csv")
View(elk)
elk <- read_csv("mt2020elk.csv")
names(elk) <- c("Year", "District", "Residency", "Hunters", "Days", "HunterDays", "Harvest", "Bulls", "Cows", "Calves", "Bow", "Rifle", "Spike", "Less6", "GE6")
deer <- read_csv("mt2020deer.csv")
View(deer)
head(deer)
View(deer)
names(deer) <- c("Year", "District", "Species",  "Residency", "Hunters", "Days", "HunterDays", "Harvest", "Bucks", "Does", "Fawns", "Bow", "Rifle", "Less4", "GE4")
head(elk)
library(cowplot)
?plot_grid
plot_grid(p1, p2)
p1 <- elk %>% filter(Residency == "SUM") %>%
ggplot(aes(x = Harvest, y = Calves))
p2 <- deer %>% filter(Residency == "SUM") %>%
ggplot(aes(x = Harvest, y = Fawns))
plot_grid(p1, p2)
plot_grid(p1, p2)
elk %>% filter(Residency == "SUM")
elk %>% filter(Residency == "SUM") %>%
ggplot(aes(x = Harvest, y = Calves))
elk %>% filter(Residency == "SUM") %>%
ggplot(aes(x = Harvest, y = Calves)) + geom_point() + theme_bw()
p1 <- elk %>% filter(Residency == "SUM") %>%
ggplot(aes(x = Harvest, y = Calves)) + geom_point() + theme_bw()
p2 <- deer %>% filter(Residency == "SUM") %>%
ggplot(aes(x = Harvest, y = Fawns)) + geom_point() + theme_bw()
plot_grid(p1, p2)
plot_grid(p1, p2, p3, p4, nrows = 2)
```
?plot_grid
library(magrittr)
library(cowplot)
p1 <- elk %>% filter(Residency == "SUM") %>%
ggplot(aes(x = Harvest, y = Calves)) + geom_point() + theme_bw()
p2 <- deer %>% filter(Residency == "SUM") %>%
ggplot(aes(x = Harvest, y = Fawns)) + geom_point() + theme_bw()
p3 <- elk %>% filter(Residency == "SUM") %>%
mutate(p.calves = Calves/Harvest) %>%
ggplot(aes(x = Harvest, y = p.calves)) + geom_point() + theme_bw()
p4 <- deer %>% filter(Residency == "SUM") %>%
mutate(p.fawns = Fawns/Harvest) %>%
ggplot(aes(x = Harvest, y = p.fawns)) + geom_point() + theme_bw()
plot_grid(p1, p2, p3, p4, nrow = 2)
View(elk)
unique(elk$District)
elk <- elk %>% filter(District %notin% c("Reg_1", "Reg_2", "Reg_4", "Reg_5", "Reg_6", "Reg_7", "State",
"XXX", "1XX", "2XX", "3XX", "4XX", "5XX", "6XX", "7XX"))
# remove the summaries
`%notin%` <- Negate(`%in%`)
elk <- elk %>% filter(District %notin% c("Reg_1", "Reg_2", "Reg_4", "Reg_5", "Reg_6", "Reg_7", "State",
"XXX", "1XX", "2XX", "3XX", "4XX", "5XX", "6XX", "7XX"))
unique(deer$District)
deer <- deer %>% filter(District %notin% c("Reg_1", "Reg_2", "Reg_4", "Reg_5", "Reg_6", "Reg_7", "State",
"XXX", "1XX", "2XX", "3XX", "4XX", "5XX", "6XX", "7XX"))
library(magrittr)
library(cowplot)
p1 <- elk %>% filter(Residency == "SUM") %>%
ggplot(aes(x = Harvest, y = Calves)) + geom_point() + theme_bw()
p2 <- deer %>% filter(Residency == "SUM") %>%
ggplot(aes(x = Harvest, y = Fawns)) + geom_point() + theme_bw()
p3 <- elk %>% filter(Residency == "SUM") %>%
mutate(p.calves = Calves/Harvest) %>%
ggplot(aes(x = Harvest, y = p.calves)) + geom_point() + theme_bw()
p4 <- deer %>% filter(Residency == "SUM") %>%
mutate(p.fawns = Fawns/Harvest) %>%
ggplot(aes(x = Harvest, y = p.fawns)) + geom_point() + theme_bw()
plot_grid(p1, p2, p3, p4, nrow = 2)
View(elk)
library(tidyverse)
setwd("D:/Current Projects/CWD/Modeling")
elk <- read_csv("mt2020elk.csv")
names(elk) <- c("Year", "District", "Residency", "Hunters", "Days", "HunterDays", "Harvest", "Bulls", "Cows", "Calves", "Bow", "Rifle", "Spike", "Less6", "GE6")
deer <- read_csv("mt2020deer.csv")
names(deer) <- c("Year", "District", "Species",  "Residency", "Hunters", "Days", "HunterDays", "Harvest", "Bucks", "Does", "Fawns", "Bow", "Rifle", "Less4", "GE4")
# remove the summaries
`%notin%` <- Negate(`%in%`)
elk <- elk %>% filter(District %notin% c("Reg_1", "Reg_2", "Reg_3","Reg_4", "Reg_5", "Reg_6", "Reg_7", "State",
"XXX", "1XX", "2XX", "3XX", "4XX", "5XX", "6XX", "7XX"))
deer <- deer %>% filter(District %notin% c("Reg_1", "Reg_2", "Reg_3", "Reg_4", "Reg_5", "Reg_6", "Reg_7", "State",
"XXX", "1XX", "2XX", "3XX", "4XX", "5XX", "6XX", "7XX"))
library(magrittr)
library(cowplot)
p1 <- elk %>% filter(Residency == "SUM") %>%
ggplot(aes(x = Harvest, y = Calves)) + geom_point() + theme_bw()
p2 <- deer %>% filter(Residency == "SUM") %>%
ggplot(aes(x = Harvest, y = Fawns)) + geom_point() + theme_bw()
p3 <- elk %>% filter(Residency == "SUM") %>%
mutate(p.calves = Calves/Harvest) %>%
ggplot(aes(x = Harvest, y = p.calves)) + geom_point() + theme_bw()
p4 <- deer %>% filter(Residency == "SUM") %>%
mutate(p.fawns = Fawns/Harvest) %>%
ggplot(aes(x = Harvest, y = p.fawns)) + geom_point() + theme_bw()
plot_grid(p1, p2, p3, p4, nrow = 2)
View(deer)
library(magrittr)
library(cowplot)
p1 <- elk %>% filter(Residency == "SUM") %>%
ggplot(aes(x = Harvest, y = Calves)) + geom_point() + theme_bw()
p2 <- deer %>% filter(Residency == "SUM", Species == "md") %>%
ggplot(aes(x = Harvest, y = Fawns)) + geom_point() + theme_bw()
p3 <- elk %>% filter(Residency == "SUM") %>%
mutate(p.calves = Calves/Harvest) %>%
ggplot(aes(x = Harvest, y = p.calves)) + geom_point() + theme_bw()
p4 <- deer %>% filter(Residency == "SUM", Species == "md") %>%
mutate(p.fawns = Fawns/Harvest) %>%
ggplot(aes(x = Harvest, y = p.fawns)) + geom_point() + theme_bw()
plot_grid(p1, p2, p3, p4, nrow = 2)
head(elk)
elk <- read_csv("elk_count.csv")
head(elk)
unique(elk$MU_state)
library(tidyverse)
setwd("D:/Current Projects/CWD/Modeling")
elk.hunt <- read_csv("mt2020elk.csv")
names(elk.hunt) <- c("Year", "District", "Residency", "Hunters", "Days", "HunterDays", "Harvest", "Bulls", "Cows", "Calves", "Bow", "Rifle", "Spike", "Less6", "GE6")
deer.hunt <- read_csv("mt2020deer.csv")
names(deer.hunt) <- c("Year", "District", "Species",  "Residency", "Hunters", "Days", "HunterDays", "Harvest", "Bucks", "Does", "Fawns", "Bow", "Rifle", "Less4", "GE4")
# remove the summaries
`%notin%` <- Negate(`%in%`)
elk.hunt <- elk.hunt %>% filter(District %notin% c("Reg_1", "Reg_2", "Reg_3","Reg_4", "Reg_5", "Reg_6", "Reg_7", "State",
"XXX", "1XX", "2XX", "3XX", "4XX", "5XX", "6XX", "7XX"))
deer.hunt <- deer.hunt %>% filter(District %notin% c("Reg_1", "Reg_2", "Reg_3", "Reg_4", "Reg_5", "Reg_6", "Reg_7", "State",
"XXX", "1XX", "2XX", "3XX", "4XX", "5XX", "6XX", "7XX"))
elk <- read_csv("elk_count.csv")
unique(elk.hunt$District)
max(elk$Year)
View(elk)
elk.hunt <- read_csv("mtelkhunt2004_2020elk.csv")
elk.hunt <- read_csv("mtelkhunt2004_2020.csv")
head(elk.hunt)
head(elk)
library(stringr)
elk <- read_csv("elk_count.csv") %>%
mutate(State = str_sub(MU_state, -1),
MU = str_su(MU_state, 1,3))
elk <- read_csv("elk_count.csv") %>%
mutate(State = str_sub(MU_state, -1),
MU = str_sub(MU_state, 1,3))
head(elk)
unique(elk$State)
unique(elk$MU)
elk <- read_csv("elk_count.csv") %>%
mutate(State = str_sub(MU_state, -1),
MU = str_extract(MU_state, "\\d+\\.?\\d*"))
head(elk)
unique(elk$MU_state)
unique(elk$MU)
elk <- read_csv("elk_count.csv") %>%
mutate(State = str_sub(MU_state, -1),
MU = str_extract(MU_state, "\\d+\\.?\\d*")) %>%
filter(State == "m")
head(elkd)
head(elk)
head(elk.hunt)
elk.hunt <- read_csv("mtelkhunt2004_2020.csv")
names(elk.hunt) <- c("Year", "District", "Residency", "Hunters", "Days", "HunterDays", "Harvest", "Bulls", "Cows", "Calves", "Bow", "Rifle", "Spike", "Less6", "GE6")
library(tidyverse)
library(stringr)
setwd("D:/Current Projects/CWD/Modeling")
elk.hunt <- read_csv("mtelkhunt2004_2020.csv")
names(elk.hunt) <- c("Year", "District", "Residency", "Hunters", "Days", "HunterDays", "Harvest", "Bulls", "Cows", "Calves", "Bow", "Rifle", "Spike", "Less6", "GE6")
deer.hunt <- read_csv("mt2020deer.csv")
names(deer.hunt) <- c("Year", "District", "Species",  "Residency", "Hunters", "Days", "HunterDays", "Harvest", "Bucks", "Does", "Fawns", "Bow", "Rifle", "Less4", "GE4")
# remove the summaries
`%notin%` <- Negate(`%in%`)
elk.hunt <- elk.hunt %>% filter(District %notin% c("Reg_1", "Reg_2", "Reg_3","Reg_4", "Reg_5", "Reg_6", "Reg_7", "State",
"XXX", "1XX", "2XX", "3XX", "4XX", "5XX", "6XX", "7XX"))
deer.hunt <- deer.hunt %>% filter(District %notin% c("Reg_1", "Reg_2", "Reg_3", "Reg_4", "Reg_5", "Reg_6", "Reg_7", "State",
"XXX", "1XX", "2XX", "3XX", "4XX", "5XX", "6XX", "7XX"))
elk <- read_csv("elk_count.csv") %>%
mutate(State = str_sub(MU_state, -1),
MU = str_extract(MU_state, "\\d+\\.?\\d*")) %>%
filter(State == "m")
head(elk)
head(elk.hunt)
elk2 <- left_join(elk.hunt, elk, by = c("Year" = "Year", "District" = "MU"))
head(elk2)
View(elk2)
ggplot(elk2, aes(x = count, y = harvest)) + geom_point() + theme_bw()
elk2 <- left_join(elk.hunt, elk, by = c("Year" = "Year", "District" = "MU"))
ggplot(elk2, aes(x = count, y = Harvest)) + geom_point() + theme_bw()
ggplot(elk2, aes(x = count, y = Harvest, color = MU)) + geom_point() + theme_bw()
ggplot(elk2, aes(x = count, y = Harvest, color = District)) + geom_point() + theme_bw()
unique(elk2$District)
library(tidyverse)
library(stringr)
setwd("D:/Current Projects/CWD/Modeling")
elk.hunt <- read_csv("mtelkhunt2004_2020.csv")
names(elk.hunt) <- c("Year", "District", "Residency", "Hunters", "Days", "HunterDays", "Harvest", "Bulls", "Cows", "Calves", "Bow", "Rifle", "Spike", "Less6", "GE6")
deer.hunt <- read_csv("mt2020deer.csv")
names(deer.hunt) <- c("Year", "District", "Species",  "Residency", "Hunters", "Days", "HunterDays", "Harvest", "Bucks", "Does", "Fawns", "Bow", "Rifle", "Less4", "GE4")
# remove the summaries
`%notin%` <- Negate(`%in%`)
elk.hunt <- elk.hunt %>% filter(District %notin% c("Reg_1", "Reg_2", "Reg_3","Reg_4", "Reg_5", "Reg_6", "Reg_7", "Reg_X", "State",
"XXX", "1XX", "2XX", "3XX", "4XX", "5XX", "6XX", "7XX"))
deer.hunt <- deer.hunt %>% filter(District %notin% c("Reg_1", "Reg_2", "Reg_3", "Reg_4", "Reg_5", "Reg_6", "Reg_7", "Reg_X", "State",
"XXX", "1XX", "2XX", "3XX", "4XX", "5XX", "6XX", "7XX"))
elk <- read_csv("elk_count.csv") %>%
mutate(State = str_sub(MU_state, -1),
MU = str_extract(MU_state, "\\d+\\.?\\d*")) %>%
filter(State == "m")
library(magrittr)
library(cowplot)
p1 <- elk.hunt %>% filter(Residency == "SUM", Year == 2020) %>%
ggplot(aes(x = Harvest, y = Calves)) + geom_point() + theme_bw()
p2 <- deer.hunt %>% filter(Residency == "SUM", Species == "md") %>%
ggplot(aes(x = Harvest, y = Fawns)) + geom_point() + theme_bw()
p3 <- elk.hunt %>% filter(Residency == "SUM", Year == 2020) %>%
mutate(p.calves = Calves/Harvest) %>%
ggplot(aes(x = Harvest, y = p.calves)) + geom_point() + theme_bw()
p4 <- deer.hunt %>% filter(Residency == "SUM", Species == "md") %>%
mutate(p.fawns = Fawns/Harvest) %>%
ggplot(aes(x = Harvest, y = p.fawns)) + geom_point() + theme_bw()
plot_grid(p1, p2, p3, p4, nrow = 2)
head(elk2)
elk2 <- left_join(elk.hunt, elk, by = c("Year" = "Year", "District" = "MU")) %>%
filter(is.na(count) == T)
head(elk2)
elk2 <- left_join(elk.hunt, elk, by = c("Year" = "Year", "District" = "MU")) %>%
filter(is.na(count) == F)
elk2 <- left_join(elk.hunt, elk, by = c("Year" = "Year", "District" = "MU")) %>%
filter(is.na(count) == F)
head(elk2)
ggplot(elk2, aes(x = count, y = Harvest, color = District)) + geom_point() + theme_bw()
elk2 <- left_join(elk.hunt, elk, by = c("Year" = "Year", "District" = "MU")) %>%
filter(is.na(count) == F) %>%
mutate(pc.harvest = Harvest / count,
pc.bulls = Bulls/count,
pc.calves = Calves/count,
pc.cows = Cows/count,
pc.spike = Spike/count)
ggplot(elk2, aes(x = count, y = Harvest, color = District)) + geom_point() + theme_bw()
library(dplyr)
elk2 <- left_join(elk.hunt, elk, by = c("Year" = "Year", "District" = "MU")) %>%
filter(is.na(count) == F) %>%
mutate(pc.harvest = Harvest / count,
pc.bulls = Bulls/count,
pc.calves = Calves/count,
pc.cows = Cows/count,
pc.spike = Spike/count)
p1 <- ggplot(elk2, aes(x = count, y = Harvest, color = District)) + geom_point() + theme_bw()
p2 <- ggplot(elk2, aes(x = count, y = pc.harvest, color = District)) + geom_point() + theme_bw() + theme(legend.position='none')
plot_grid(p1, p2)
hist(elk2$Harvest)
hist(elk2$Harvest, nbins = 40)
hist(elk2$Harvest, nbin = 40)
?hist
hist(elk2$Harvest, breaks = 40)
library(dplyr)
elk2 <- left_join(elk.hunt, elk, by = c("Year" = "Year", "District" = "MU")) %>%
filter(is.na(count) == F) %>%
mutate(pc.harvest = Harvest / count,
pc.bulls = Bulls/count,
pc.calves = Calves/count,
pc.cows = Cows/count,
pc.spike = Spike/count)
# only use areas where the harvest was X or more
p1 <- elk2 %>% filter(Harvest >=50) %>% ggplot(aes(x = count, y = Harvest, color = District)) + geom_point() + theme_bw()
p2 <- elk2 %>% filter(Harvest >=50) %>% ggplot(aes(x = count, y = pc.harvest, color = District)) + geom_point() + theme_bw() + theme(legend.position='none')
plot_grid(p1, p2)
p1 <- elk2 %>% filter(Harvest >=50) %>% ggplot(aes(x = count, y = Harvest, color = District)) + geom_point() + theme_bw()
p2 <- elk2 %>% filter(Harvest >=50) %>% ggplot(aes(x = count, y = pc.harvest, color = District)) + geom_point() + theme_bw() + theme(legend.position='none')
plot_grid(p1, p2)
p1 <- elk2 %>% filter(Harvest >=50) %>% ggplot(aes(x = count, y = Harvest, color = District)) + geom_point() + theme_bw()
p2 <- elk2 %>% filter(Harvest >=50) %>% ggplot(aes(x = count, y = pc.harvest, color = District)) + geom_point() + theme_bw() + theme(legend.position='none')
plot_grid(p1, p2)
library(dplyr)
elk2 <- left_join(elk.hunt, elk, by = c("Year" = "Year", "District" = "MU")) %>%
filter(is.na(count) == F) %>%
mutate(pc.harvest = Harvest / count,
pc.bulls = Bulls/count,
pc.calves = Calves/count,
pc.cows = Cows/count,
pc.spike = Spike/count)
# only use areas where the harvest was X or more and the count is >= Y
p1 <- elk2 %>% filter(Harvest >=50 & count >=500) %>% ggplot(aes(x = count, y = Harvest, color = District)) + geom_point() + theme_bw()
p2 <- elk2 %>% filter(Harvest >=50 & count >=500) %>% ggplot(aes(x = count, y = pc.harvest, color = District)) + geom_point() + theme_bw() + theme(legend.position='none')
plot_grid(p1, p2)
# only use areas where the harvest was X or more and the count is >= Y
elk.sub <- elk2 %>% filter(Harvest >=10 & count >=500)
ggplot(elk.sub, aes(x = pc.cows, y = count, color = Year)) + geom_path() + theme_bw() +
theme(legend.position='none') + facet_grid(~District)
?facet_grid
ggplot(elk.sub, aes(x = count, y = pc.cows, color = Year)) + geom_path() + theme_bw() +
theme(legend.position='none') + facet_grid(~District, ncols = 5)
ggplot(elk.sub, aes(x = count, y = pc.cows, color = Year)) + geom_path() + theme_bw() +
theme(legend.position='none') + facet_grid(~District, cols = 5)
?facet_wrap
ggplot(elk.sub, aes(x = count, y = pc.cows, color = Year)) + geom_path() + theme_bw() +
theme(legend.position='none') + facet_wrap(~District, ncol = 5)
ggplot(elk.sub, aes(x = count, y = pc.cows, color = Year)) + geom_path() + theme_bw() +
theme(legend.position='none') + facet_wrap(~District, ncol = 5, scales = "free")
ggplot(elk.sub, aes(x = count, y = pc.cows, color = Year)) + geom_path() + theme_bw() +
theme(legend.position='none') + facet_wrap(~District, ncol = 5, scales = "free")
ggplot(elk.sub, aes(x = count, y = pc.cows, color = Year)) + geom_point() + theme_bw() +
theme(legend.position='none') + facet_wrap(~District, ncol = 5, scales = "free")
ggplot(elk.sub, aes(x = count, y = pc.cows, color = Year)) + geom_point() + theme_bw() +
theme(legend.position='none') + facet_wrap(~District, ncol = 5, scales = "free")
ggplot(elk.sub, aes(x = count, y = pc.cows, color = Year)) + geom_point() + theme_bw() +
theme(legend.position='right') + facet_wrap(~District, ncol = 5, scales = "free")
ggplot(elk.sub, aes(x = count, y = pc.cows, color = Year)) + geom_point() + theme_bw() +
theme(legend.position='right') + facet_wrap(~District, ncol = 5)
summary(elk.sub)
elk2 %>% filter(District %notin% c("322", "560")) %>% filter(count >= 1000) %>%
ggplot(aes(x = count, y = pc.cows, color = District)) + geom_point() + theme_bw() +
theme(legend.position='none')
elk2 %>% filter(District %notin% c("322", "560")) %>% filter(count >= 1000) %>%
ggplot(aes(x = count, y = pc.cows, color = District)) + geom_point() + theme_bw() +
theme(legend.position='none')
